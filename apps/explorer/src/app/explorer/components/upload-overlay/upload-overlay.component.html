<!--
  ~ Copyright (c) 2023. IdrisovII & EustroSoft.org
  ~
  ~ This file is part of eustrosoft-front project.
  ~ See the LICENSE file at the project root for licensing information.
  -->

<div class="upload-overlay">
  <div class="upload-overlay-controls">
    <eustrosoft-front-button
      [buttonType]="'button'"
      [buttonStyleType]="'stroked'"
      [buttonText]="'Start upload'"
      [color]="'primary'"
      (clicked)="runUpload()"
    >
    </eustrosoft-front-button>
    <eustrosoft-front-button
      [buttonType]="'button'"
      [buttonStyleType]="'icon'"
      [iconName]="'close'"
      (clicked)="close()"
    >
    </eustrosoft-front-button>
  </div>
  <cdk-virtual-scroll-viewport itemSize="5" class="upload-overlay-items">
    <div
      *ngFor="let item of uploadItems.controls; let i = index"
      class="upload-overlay-items-wrapper"
      [hidden]="item.controls.uploadItem.value.cancelled"
    >
      <div class="upload-overlay-items-wrapper-item">
        <span class="upload-overlay-items-wrapper-item-filename">
          {{ item.controls.uploadItem.value.file.name }}
        </span>
        <eustrosoft-front-select
          [label]="'Security level'"
          [control]="item.controls.securityLevel"
          [options]="(securityLevelOptions$ | async) || []"
          [fieldAppearance]="'outline'"
        ></eustrosoft-front-select>
        <eustrosoft-front-input
          [label]="'Note'"
          [control]="item.controls.description"
          [placeholder]="'Some additional info'"
          [fieldAppearance]="'outline'"
        ></eustrosoft-front-input>
        <eustrosoft-front-button
          [hidden]="
            item.controls.uploadItem.value.state === UploadingState.UPLOADED
          "
          [buttonType]="'button'"
          [buttonStyleType]="'icon'"
          [iconName]="'cancel'"
          [color]="'warn'"
          (clicked)="remove(item, i)"
          class="upload-overlay-items-wrapper-item-cancel-button"
        >
        </eustrosoft-front-button>
        <eustrosoft-front-button
          [hidden]="
            item.controls.uploadItem.value.state === UploadingState.PENDING ||
            item.controls.uploadItem.value.state === UploadingState.UPLOADING
          "
          [buttonType]="'button'"
          [buttonStyleType]="'icon'"
          [iconName]="'folder'"
          [color]="'primary'"
          (clicked)="openFolder(item)"
          class="upload-overlay-items-wrapper-item-open-folder-button"
        >
        </eustrosoft-front-button>
      </div>
      <eustrosoft-front-progress-bar
        [mode]="'determinate'"
        [value]="item.controls.uploadItem.value.progress"
        class="upload-overlay-items-wrapper-progress"
      ></eustrosoft-front-progress-bar>
    </div>
  </cdk-virtual-scroll-viewport>
</div>
