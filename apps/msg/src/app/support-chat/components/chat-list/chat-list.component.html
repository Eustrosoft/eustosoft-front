<!--
  ~ Copyright (c) 2023. IdrisovII & EustroSoft.org
  ~
  ~ This file is part of eustrosoft-front project.
  ~ See the LICENSE file at the project root for licensing information.
  -->

<div class="d-flex flex-column h-inherit">
  <div
    [ngClass]="{ 'rounded-top': !removeBorderRadius }"
    class="flex-grow-0 flex-shrink-0 bg-secondary bg-opacity-25"
  >
    <div class="d-flex align-items-center justify-content-between p-1">
      <div class="d-flex align-items-center">
        <eustrosoft-front-button
          [buttonType]="'button'"
          [buttonStyleType]="'icon'"
          [iconName]="'menu'"
          class="d-sm-none"
          (clicked)="collapseClicked.emit()"
        ></eustrosoft-front-button>
        <h2 class="mb-0">{{ 'MSG.TICKET_LIST_HEADER_TEXT' | translate }}</h2>
      </div>
      <div class="d-flex align-items-center">
        <eustrosoft-front-button
          [buttonType]="'button'"
          [buttonStyleType]="'icon'"
          [iconName]="'add'"
          (clicked)="createNewChat()"
        ></eustrosoft-front-button>
        <eustrosoft-front-button
          [buttonType]="'button'"
          [buttonStyleType]="'icon'"
          [iconName]="'more_vert'"
          [matMenuTriggerFor]="menu"
          [hidden]="'hidden'"
        ></eustrosoft-front-button>
        <mat-menu #menu="matMenu">
          <button mat-menu-item>
            <mat-icon>settings</mat-icon>
            Settings
          </button>
        </mat-menu>
      </div>
    </div>
  </div>
  <div class="flex-grow-1 h-100">
    <mat-list *ngIf="chats.length > 0; else noChatsTemplate" class="h-100">
      <virtual-scroller #scroll [items]="chats" class="h-100">
        <ng-container
          *ngFor="let chat of scroll.viewPortItems; trackBy: trackByFn"
        >
          <mat-list-item
            eustrosoftFrontHoverCursor
            eustrosoftFrontHover
            [hoverClasses]="['shadow-lg']"
            [ngClass]="{
              'border-3 border-start border-secondary bg-secondary bg-opacity-25':
                selectedChat && selectedChat.zoid === chat.zoid
            }"
            class="p-2 my-2 rounded-start"
            lines="3"
            (click)="selectChat(chat)"
          >
            <span matListItemTitle>{{ chat.subject }}</span>
            <span class="fst-italic">
              {{ chat.status | msgChatStatus }}
            </span>
          </mat-list-item>
          <mat-divider></mat-divider>
        </ng-container>
      </virtual-scroller>
    </mat-list>
  </div>
</div>

<ng-template #noChatsTemplate>
  <div
    class="d-flex flex-column align-items-center justify-content-center text-center h-inherit"
  >
    <h2>{{ 'MSG.CREATE_NEW_CHAT_BUTTON_TEXT' | translate }}</h2>
    <eustrosoft-front-button
      [buttonType]="'button'"
      [buttonStyleType]="'icon'"
      [iconName]="'add'"
      (clicked)="createNewChat()"
    ></eustrosoft-front-button>
  </div>
</ng-template>
